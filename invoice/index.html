<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Dubbing Invoice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        @font-face {
            font-family: 'SF Pro Text';
            src: url('https://cdn.jsdelivr.net/gh/sahibjotsaggu/SFPro-Fonts/SF-Pro-Text-Regular.woff2') format('woff2'),
                url('https://cdn.jsdelivr.net/gh/sahibjotsaggu/SFPro-Fonts/SF-Pro-Text-Regular.woff') format('woff');
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: 'SF Pro Text';
            src: url('https://cdn.jsdelivr.net/gh/sahibjotsaggu/SFPro-Fonts/SF-Pro-Text-Medium.woff2') format('woff2'),
                url('https://cdn.jsdelivr.net/gh/sahibjotsaggu/SFPro-Fonts/SF-Pro-Text-Medium.woff') format('woff');
            font-weight: 500;
            font-style: normal;
        }

        @font-face {
            font-family: 'SF Pro Display';
            src: url('https://cdn.jsdelivr.net/gh/sahibjotsaggu/SFPro-Fonts/SF-Pro-Display-Bold.woff2') format('woff2'),
                url('https://cdn.jsdelivr.net/gh/sahibjotsaggu/SFPro-Fonts/SF-Pro-Display-Bold.woff') format('woff');
            font-weight: 700;
            font-style: normal;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #e6e9f0 0%, #eef1f5 100%);
            margin: 0;
            padding: 30px;
            color: #1a1a1a;
            -webkit-text-size-adjust: 100%;
            /* keep text consistent on iOS/Android */
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #1a252f;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-weight: 700;
            font-size: 32px;
            letter-spacing: -0.5px;
        }

        body {
            font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #e6e9f0 0%, #eef1f5 100%);
            margin: 0;
            padding: 30px;
            color: #1a1a1a;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #1a252f;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-weight: 700;
            font-size: 32px;
            letter-spacing: -0.5px;
        }

        .form-section {
            background: #ffffff;
            padding: 30px;
            margin: auto;
            max-width: 900px;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        label {
            font-weight: 600;
            display: block;
            margin-top: 15px;
            color: #2c3e50;
            font-size: 14px;
            letter-spacing: 0.2px;
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 12px;
            margin-top: 6px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 16px;
            background: #f8fafc;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #4b5ef5;
            box-shadow: 0 0 0 3px rgba(75, 94, 245, 0.2);
        }

        button {
            background: linear-gradient(135deg, #4b5ef5 0%, #3b46c4 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 16px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            transition: all 0.3s ease;
            width: 100%;
            max-width: 300px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 6px 20px rgba(75, 94, 245, 0.3);
            touch-action: manipulation;
        }

        button:hover {
            background: linear-gradient(135deg, #3b46c4 0%, #4b5ef5 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(75, 94, 245, 0.4);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(75, 94, 245, 0.2);
        }

        .dubbing-row {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            background: #f9fafb;
            transition: background 0.2s ease;
        }

        .dubbing-row:hover {
            background: #f1f5f9;
        }

        .dubbing-row:nth-child(even) {
            background: #f3f4f6;
        }

        .dubbing-row:nth-child(even):hover {
            background: #eceff1;
        }

        .deleteBtn {
            background: linear-gradient(135deg, #e3342f 0%, #cc1f1a 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(227, 52, 47, 0.3);
            display: block;
            width: 100%;
            max-width: 140px;
            margin: 15px auto 0;
            text-align: center;
        }

        .deleteBtn:hover {
            background: linear-gradient(135deg, #cc1f1a 0%, #e3342f 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(227, 52, 47, 0.4);
        }

        .deleteBtn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(227, 52, 47, 0.2);
        }

        /* ===== Invoice (captured to PDF) ===== */
        #invoice {
            display: none;
            background: #fff;
            width: 100%;
            max-width: 760px;
            padding: 40px;
            margin: auto;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }

        #invoice header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #1a252f;
            padding-bottom: 12px;
            margin-bottom: 25px;
        }

        #invoice header h2 {
            margin: 0;
            font-size: 28px;
            color: #1a252f;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        #invoice header .date {
            font-size: 13px;
            color: #1a252f;
            font-weight: 500;
        }

        .section {
            margin-top: 20px;
        }

        .section h3 {
            margin-bottom: 10px;
            font-size: 16px;
            color: #1a252f;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 6px;
            font-weight: 600;
        }

        .section p {
            margin: 6px 0;
            font-size: 13px;
            white-space: pre-line;
            color: #2d3748;
        }

        .gst-label {
            font-weight: 600;
            display: inline;
            margin-right: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
        }

        th,
        td {
            border: 1px solid #e5e7eb;
            padding: 10px;
            text-align: left;
            font-size: 13px;
        }

        th {
            background: #1a252f;
            color: #fff;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        td {
            background: #f9fafb;
        }

        .total {
            text-align: right;
            font-weight: 700;
            padding: 12px 0 0;
            font-size: 15px;
            border-top: 2px solid #1a252f;
            color: #1a252f;
        }

        .bank,
        .signature {
            margin-top: 35px;
            font-size: 13px;
            color: #2d3748;
        }

        .bank p {
            margin: 6px 0;
        }

        .signature {
            text-align: right;
            font-weight: 700;
            margin-top: 70px;
            font-size: 15px;
            color: #1a252f;
        }

        /* Prevent breaks inside these */
        .bank,
        .signature,
        .section,
        tr {
            page-break-inside: avoid;
        }

        /* Mobile responsiveness */
        @media (max-width: 600px) {
            body {
                padding: 15px;
            }

            h1 {
                font-size: 24px;
            }

            .form-section {
                padding: 20px;
            }

            input,
            select,
            textarea {
                font-size: 14px;
                padding: 10px;
            }

            button {
                font-size: 14px;
                padding: 12px;
            }

            .dubbing-row {
                padding: 15px;
            }

            .deleteBtn {
                font-size: 12px;
                padding: 8px;
                max-width: 120px;
            }

            #invoice {
                padding: 20px;
            }

            #invoice header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>

<body>

    <h1>Dubbing Invoice</h1>
    <div class="form-section">
        <h3>Client Details</h3>
        <label>Choose Client</label>
        <select id="clientSelect" onchange="fillClientData()">
            <option value="new">New Client</option>
            <option value="subhash">Subhash Studios Private Limited</option>
        </select>

        <label>Client Name</label>
        <input id="clientName">
        <label>Client Contact</label>
        <input type="number" id="clientContact">
        <label>Client Address</label>
        <textarea id="clientAddress"></textarea>
        <label>Client GSTIN</label>
        <input id="clientGST">

        <h3>Dubbing Work</h3>
        <div id="dubbingRows"></div>
        <button type="button" onclick="addRow()">Add Dub</button>

        <button type="button" onclick="generateInvoice()">Generate Invoice</button>
    </div>

    <div id="invoice">
        <header>
            <h2>Invoice</h2>
            <div class="date">Date: <span id="invoiceDate"></span></div>
        </header>

        <div class="section">
            <h3>From</h3>
            <p><strong>Jullie Devaani</strong></p>
            <p>7506242650</p>
            <p>B-70, Vardhman Nagar,<br>Nursing Lane, Malad West,<br>Mumbai-64</p>
            <p>jullie.devaani@gmail.com</p>
        </div>

        <div class="section">
            <h3>Bill To</h3>
            <p><strong id="outClientName"></strong></p>
            <p id="outClientContact"></p>
            <p id="outClientAddress"></p>
            <p><span class="gst-label">GSTIN:</span> <span id="outClientGST"></span></p>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Dubbing Date</th>
                    <th>Series/Movie</th>
                    <th>Characters</th>
                    <th>Director</th>
                    <th>Episodes</th>
                    <th>Amount (₹)</th>
                </tr>
            </thead>
            <tbody id="invoiceTable"></tbody>
        </table>

        <div class="total">Total: ₹<span id="outTotal"></span></div>

        <div class="bank">
            <strong>Bank Details:</strong>
            <p>Bank of Baroda</p>
            <p>A/C No: 99730100000419</p>
            <p>IFSC: BARB0DBMONT (fifth character is zero)</p>
            <p>Branch: Mount Poinsur</p>
            <p>UPI No: 7506242650</p>
        </div>

        <div class="signature">Jullie Devaani</div>
    </div>

    <script>
        const clientData = {
            subhash: {
                name: "Subhash Studios Private Limited",
                address: "201, Nimbus Centre, Plot Number 69,\nOberoi Complex, Near Laxmi Industrial Estate,\nAndheri West, Mumbai-53, Maharashtra",
                contact: "9930405505",
                gst: "27AABCS1126R1Z3"
            }
        };

        function getValueOrDash(el) {
            return el.value.trim() || "-";
        }

        function fillClientData() {
            const sel = document.getElementById("clientSelect").value;
            if (sel === "subhash") {
                document.getElementById("clientName").value = clientData.subhash.name;
                document.getElementById("clientContact").value = clientData.subhash.contact;
                document.getElementById("clientAddress").value = clientData.subhash.address;
                document.getElementById("clientGST").value = clientData.subhash.gst;
            } else {
                document.getElementById("clientName").value = "";
                document.getElementById("clientContact").value = "";
                document.getElementById("clientAddress").value = "";
                document.getElementById("clientGST").value = "";
            }
        }

        function createRow(isFirst = false) {
            const row = document.createElement("div");
            row.classList.add("dubbing-row");
            row.innerHTML = `
                <label>Dubbing Date <span style="color:red">*</span></label>
                <input type="date" class="dubDate" required>
                <label>Series/Movie Name</label>
                <input class="seriesName">
                <label>Characters Voiced</label>
                <input class="characters">
                <label>Dubbing Director</label>
                <input class="director">
                <label>Episode Numbers</label>
                <input class="episodes">
                <label>Amount (₹)</label>
                <input type="number" class="amount">
            `;
            if (!isFirst) {
                const btn = document.createElement("button");
                btn.textContent = "Delete";
                btn.className = "deleteBtn";
                btn.onclick = () => row.remove();
                row.appendChild(btn);
            }
            return row;
        }

        function addRow() {
            document.getElementById("dubbingRows").appendChild(createRow());
        }

        function fillInvoiceTable() {
            const table = document.getElementById("invoiceTable");
            table.innerHTML = "";
            let total = 0;
            const rows = document.querySelectorAll("#dubbingRows .dubbing-row");
            for (let r of rows) {
                const dateEl = r.querySelector(".dubDate");
                if (!dateEl.value.trim()) {
                    alert("All dubbing rows must have a date filled in.");
                    return false;
                }
                const date = new Date(dateEl.value).toLocaleDateString("en-GB", {
                    day: "2-digit",
                    month: "2-digit",
                    year: "numeric"
                }).split("/").join("-");
                const series = getValueOrDash(r.querySelector(".seriesName"));
                const chars = getValueOrDash(r.querySelector(".characters"));
                const dir = getValueOrDash(r.querySelector(".director"));
                const eps = getValueOrDash(r.querySelector(".episodes"));
                const amt = r.querySelector(".amount").value.trim() || "-";
                if (amt !== "-") total += parseFloat(amt);

                const tr = document.createElement("tr");
                tr.innerHTML = `<td>${date}</td><td>${series}</td><td>${chars}</td><td>${dir}</td><td>${eps}</td><td>${amt}</td>`;
                table.appendChild(tr);
            }
            document.getElementById("outTotal").textContent = total.toFixed(2);
            return true;
        }

        async function generateInvoice() {
            if (!fillInvoiceTable()) return;

            document.getElementById("invoiceDate").textContent =
                new Date().toLocaleDateString("en-GB", {
                    day: "2-digit",
                    month: "2-digit",
                    year: "numeric"
                }).split("/").join("-");
            document.getElementById("outClientName").textContent =
                getValueOrDash(document.getElementById("clientName"));
            document.getElementById("outClientContact").textContent =
                getValueOrDash(document.getElementById("clientContact"));
            document.getElementById("outClientAddress").textContent =
                getValueOrDash(document.getElementById("clientAddress"));
            document.getElementById("outClientGST").textContent =
                getValueOrDash(document.getElementById("clientGST"));

            const el = document.getElementById("invoice");
            el.style.display = "block";
            await new Promise(r => requestAnimationFrame(r));

            const opt = {
                filename: "JullieDevaaniInvoice.pdf",
                margin: [10, 10, 10, 10],
                image: { type: "jpeg", quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true, scrollX: 0, scrollY: 0 },
                jsPDF: { unit: "pt", format: "a4", orientation: "portrait" },
                pagebreak: { mode: ["css", "legacy"] }
            };

            await html2pdf().set(opt).from(el).save();
        }

        window.onload = () => {
            document.getElementById("dubbingRows").appendChild(createRow(true));
        };
    </script>

</body>

</html>